# 一、数据类型

## 1. String

- 字符串

- 数值

  场景：session，kv 缓存，分布式文件系统

- 二进制位操作

  bitmap

  每次开辟一个字节，位索引从左到右递增

  正负双向索引：

  - 正向索引 - 索引位置 n 代表从左到右第 n 个数据
  - 负向索引 - -n 从右到左第 n 个数据

  场景：   

  1. 任意时间窗口，用户登录情况
  2. 查看活跃用户数

二进制安全：将数据序列化，以字节码的形式存储，需要在 C/S 端使用相应的协议。

## 2. List

数据结构：双向链表，key 指向链表的头结点和尾结点

场景：

1. 消息队列
2. 评论列表
3. 替代 java 容器：使 JVM 无状态，出现故障时数据不丢失（JVM 宕机）、在高并发场景下加快速度

## 3. Hash

 场景：

1. 聚集数据
2. 表单详情

## 4. Set

无序，不重复

集合操作 Cpu 密集操作，阻塞线程

场景：

1. 抽奖，验证码，扑克牌游戏
2. 交并差集合操作，共同好友，好友推荐 

## 5. Sorted Set

场景：

1. 排行榜
2. 评论：无序分页

底层实现 

1. 动态排序
2. 数据结构
   - ziplist
   - skiplist

# 二、Redis 持久化

## 1. snapshot

RDB, image, bak

特点：

- 全量存储，丢失量较大
- 体积接近于真实数据，恢复速度快

## 2. 日志

AOF

# 三、Redis 高可用性的保障

## (一) 单机程序存在的问题

### 1. 单点故障不可用

主备复制集群，全量数据

### 2. 压力/性能问题

分片集群，非全量数据

一般来说是复合使用，提高可用性和扩展性

##  (二) Redis HA (High Availability)

### 1. 弱一致性

